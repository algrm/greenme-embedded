/* ----------------------------------------------------------------------    
* Copyright (C) 2010 ARM Limited. All rights reserved.    
*    
* $Date:        15. February 2012  
* $Revision: 	V1.1.0  
*    
* Project: 	    CMSIS DSP Library    
* Title:	    arm_cfft_radix4_init_q15.c    
*    
* Description:	Radix-4 Decimation in Frequency Q15 FFT & IFFT initialization function    
*    
* Target Processor: Cortex-M4/Cortex-M3/Cortex-M0
*  
* Version 1.1.0 2012/02/15 
*    Updated with more optimizations, bug fixes and minor API changes.  
*   
* Version 1.0.10 2011/7/15  
*    Big Endian support added and Merged M0 and M3/M4 Source code.   
*    
* Version 1.0.3 2010/11/29   
*    Re-organized the CMSIS folders and updated documentation.    
*     
* Version 1.0.2 2010/11/11    
*    Documentation updated.     
*    
* Version 1.0.1 2010/10/05     
*    Production release and review comments incorporated.    
*    
* Version 1.0.0 2010/09/20     
*    Production release and review comments incorporated.    
*    
* Version 0.0.5  2010/04/26     
* 	 incorporated review comments and updated with latest CMSIS layer    
*    
* Version 0.0.3  2010/03/10     
*    Initial version    
* -------------------------------------------------------------------- */

#include "arm_math.h"
#include "arm_common_tables.h"

/**    
 * @ingroup groupTransforms    
 */


/**    
 * @addtogroup Radix4_CFFT_CIFFT    
 * @{    
 */


/**    
* @brief Initialization function for the Q15 CFFT/CIFFT.   
* @param[in,out] *S             points to an instance of the Q15 CFFT/CIFFT structure.   
* @param[in]     fftLen         length of the FFT.   
* @param[in]     ifftFlag       flag that selects forward (ifftFlag=0) or inverse (ifftFlag=1) transform.   
* @param[in]     bitReverseFlag flag that enables (bitReverseFlag=1) or disables (bitReverseFlag=0) bit reversal of output.   
* @return        The function returns ARM_MATH_SUCCESS if initialization is successful or ARM_MATH_ARGUMENT_ERROR if <code>fftLen</code> is not a supported value.   
*    
* \par Description:   
* \par    
* The parameter <code>ifftFlag</code> controls whether a forward or inverse transform is computed.    
* Set(=1) ifftFlag for calculation of CIFFT otherwise  CFFT is calculated   
* \par    
* The parameter <code>bitReverseFlag</code> controls whether output is in normal order or bit reversed order.    
* Set(=1) bitReverseFlag for output to be in normal order otherwise output is in bit reversed order.    
* \par    
* The parameter <code>fftLen</code>	Specifies length of CFFT/CIFFT process. Supported FFT Lengths are 16, 64, 256, 1024.    
* \par    
* This Function also initializes Twiddle factor table pointer and Bit reversal table pointer.    
*/
/*
const q15_t ALIGN4 twiddleCoefQ15N512[768] = {
0x7fff, 0x0,0x7ffe, 0x192,0x7ff6, 0x324,0x7fea, 0x4b6,
0x7fd9, 0x648,0x7fc2, 0x7d9,0x7fa7, 0x96b,0x7f87, 0xafb,
0x7f62, 0xc8c,0x7f38, 0xe1c,0x7f0a, 0xfab,0x7ed6, 0x113a,
0x7e9d, 0x12c8,0x7e60, 0x1455,0x7e1e, 0x15e2,0x7dd6, 0x176e,
0x7d8a, 0x18f9,0x7d3a, 0x1a83,0x7ce4, 0x1c0c,0x7c89, 0x1d93,
0x7c2a, 0x1f1a,0x7bc6, 0x209f,0x7b5d, 0x2224,0x7aef, 0x23a7,
0x7a7d, 0x2528,0x7a06, 0x26a8,0x798a, 0x2827,0x790a, 0x29a4,
0x7885, 0x2b1f,0x77fb, 0x2c99,0x776c, 0x2e11,0x76d9, 0x2f87,
0x7642, 0x30fc,0x75a6, 0x326e,0x7505, 0x33df,0x7460, 0x354e,
0x73b6, 0x36ba,0x7308, 0x3825,0x7255, 0x398d,0x719e, 0x3af3,
0x70e3, 0x3c57,0x7023, 0x3db8,0x6f5f, 0x3f17,0x6e97, 0x4074,
0x6dca, 0x41ce,0x6cf9, 0x4326,0x6c24, 0x447b,0x6b4b, 0x45cd,
0x6a6e, 0x471d,0x698c, 0x486a,0x68a7, 0x49b4,0x67bd, 0x4afb,
0x66d0, 0x4c40,0x65de, 0x4d81,0x64e9, 0x4ec0,0x63ef, 0x4ffb,
0x62f2, 0x5134,0x61f1, 0x5269,0x60ec, 0x539b,0x5fe4, 0x54ca,
0x5ed7, 0x55f6,0x5dc8, 0x571e,0x5cb4, 0x5843,0x5b9d, 0x5964,
0x5a82, 0x5a82,0x5964, 0x5b9d,0x5843, 0x5cb4,0x571e, 0x5dc8,
0x55f6, 0x5ed7,0x54ca, 0x5fe4,0x539b, 0x60ec,0x5269, 0x61f1,
0x5134, 0x62f2,0x4ffb, 0x63ef,0x4ec0, 0x64e9,0x4d81, 0x65de,
0x4c40, 0x66d0,0x4afb, 0x67bd,0x49b4, 0x68a7,0x486a, 0x698c,
0x471d, 0x6a6e,0x45cd, 0x6b4b,0x447b, 0x6c24,0x4326, 0x6cf9,
0x41ce, 0x6dca,0x4074, 0x6e97,0x3f17, 0x6f5f,0x3db8, 0x7023,
0x3c57, 0x70e3,0x3af3, 0x719e,0x398d, 0x7255,0x3825, 0x7308,
0x36ba, 0x73b6,0x354e, 0x7460,0x33df, 0x7505,0x326e, 0x75a6,
0x30fc, 0x7642,0x2f87, 0x76d9,0x2e11, 0x776c,0x2c99, 0x77fb,
0x2b1f, 0x7885,0x29a4, 0x790a,0x2827, 0x798a,0x26a8, 0x7a06,
0x2528, 0x7a7d,0x23a7, 0x7aef,0x2224, 0x7b5d,0x209f, 0x7bc6,
0x1f1a, 0x7c2a,0x1d93, 0x7c89,0x1c0c, 0x7ce4,0x1a83, 0x7d3a,
0x18f9, 0x7d8a,0x176e, 0x7dd6,0x15e2, 0x7e1e,0x1455, 0x7e60,
0x12c8, 0x7e9d,0x113a, 0x7ed6,0xfab, 0x7f0a,0xe1c, 0x7f38,
0xc8c, 0x7f62,0xafb, 0x7f87,0x96b, 0x7fa7,0x7d9, 0x7fc2,
0x648, 0x7fd9,0x4b6, 0x7fea,0x324, 0x7ff6,0x192, 0x7ffe,
0x0, 0x7fff,0xfe6e, 0x7ffe,0xfcdc, 0x7ff6,0xfb4a, 0x7fea,
0xf9b8, 0x7fd9,0xf827, 0x7fc2,0xf695, 0x7fa7,0xf505, 0x7f87,
0xf374, 0x7f62,0xf1e4, 0x7f38,0xf055, 0x7f0a,0xeec6, 0x7ed6,
0xed38, 0x7e9d,0xebab, 0x7e60,0xea1e, 0x7e1e,0xe892, 0x7dd6,
0xe707, 0x7d8a,0xe57d, 0x7d3a,0xe3f4, 0x7ce4,0xe26d, 0x7c89,
0xe0e6, 0x7c2a,0xdf61, 0x7bc6,0xdddc, 0x7b5d,0xdc59, 0x7aef,
0xdad8, 0x7a7d,0xd958, 0x7a06,0xd7d9, 0x798a,0xd65c, 0x790a,
0xd4e1, 0x7885,0xd367, 0x77fb,0xd1ef, 0x776c,0xd079, 0x76d9,
0xcf04, 0x7642,0xcd92, 0x75a6,0xcc21, 0x7505,0xcab2, 0x7460,
0xc946, 0x73b6,0xc7db, 0x7308,0xc673, 0x7255,0xc50d, 0x719e,
0xc3a9, 0x70e3,0xc248, 0x7023,0xc0e9, 0x6f5f,0xbf8c, 0x6e97,
0xbe32, 0x6dca,0xbcda, 0x6cf9,0xbb85, 0x6c24,0xba33, 0x6b4b,
0xb8e3, 0x6a6e,0xb796, 0x698c,0xb64c, 0x68a7,0xb505, 0x67bd,
0xb3c0, 0x66d0,0xb27f, 0x65de,0xb140, 0x64e9,0xb005, 0x63ef,
0xaecc, 0x62f2,0xad97, 0x61f1,0xac65, 0x60ec,0xab36, 0x5fe4,
0xaa0a, 0x5ed7,0xa8e2, 0x5dc8,0xa7bd, 0x5cb4,0xa69c, 0x5b9d,
0xa57e, 0x5a82,0xa463, 0x5964,0xa34c, 0x5843,0xa238, 0x571e,
0xa129, 0x55f6,0xa01c, 0x54ca,0x9f14, 0x539b,0x9e0f, 0x5269,
0x9d0e, 0x5134,0x9c11, 0x4ffb,0x9b17, 0x4ec0,0x9a22, 0x4d81,
0x9930, 0x4c40,0x9843, 0x4afb,0x9759, 0x49b4,0x9674, 0x486a,
0x9592, 0x471d,0x94b5, 0x45cd,0x93dc, 0x447b,0x9307, 0x4326,
0x9236, 0x41ce,0x9169, 0x4074,0x90a1, 0x3f17,0x8fdd, 0x3db8,
0x8f1d, 0x3c57,0x8e62, 0x3af3,0x8dab, 0x398d,0x8cf8, 0x3825,
0x8c4a, 0x36ba,0x8ba0, 0x354e,0x8afb, 0x33df,0x8a5a, 0x326e,
0x89be, 0x30fc,0x8927, 0x2f87,0x8894, 0x2e11,0x8805, 0x2c99,
0x877b, 0x2b1f,0x86f6, 0x29a4,0x8676, 0x2827,0x85fa, 0x26a8,
0x8583, 0x2528,0x8511, 0x23a7,0x84a3, 0x2224,0x843a, 0x209f,
0x83d6, 0x1f1a,0x8377, 0x1d93,0x831c, 0x1c0c,0x82c6, 0x1a83,
0x8276, 0x18f9,0x822a, 0x176e,0x81e2, 0x15e2,0x81a0, 0x1455,
0x8163, 0x12c8,0x812a, 0x113a,0x80f6, 0xfab,0x80c8, 0xe1c,
0x809e, 0xc8c,0x8079, 0xafb,0x8059, 0x96b,0x803e, 0x7d9,
0x8027, 0x648,0x8016, 0x4b6,0x800a, 0x324,0x8002, 0x192,
0x8000, 0x0,0x8002, 0xfe6e,0x800a, 0xfcdc,0x8016, 0xfb4a,
0x8027, 0xf9b8,0x803e, 0xf827,0x8059, 0xf695,0x8079, 0xf505,
0x809e, 0xf374,0x80c8, 0xf1e4,0x80f6, 0xf055,0x812a, 0xeec6,
0x8163, 0xed38,0x81a0, 0xebab,0x81e2, 0xea1e,0x822a, 0xe892,
0x8276, 0xe707,0x82c6, 0xe57d,0x831c, 0xe3f4,0x8377, 0xe26d,
0x83d6, 0xe0e6,0x843a, 0xdf61,0x84a3, 0xdddc,0x8511, 0xdc59,
0x8583, 0xdad8,0x85fa, 0xd958,0x8676, 0xd7d9,0x86f6, 0xd65c,
0x877b, 0xd4e1,0x8805, 0xd367,0x8894, 0xd1ef,0x8927, 0xd079,
0x89be, 0xcf04,0x8a5a, 0xcd92,0x8afb, 0xcc21,0x8ba0, 0xcab2,
0x8c4a, 0xc946,0x8cf8, 0xc7db,0x8dab, 0xc673,0x8e62, 0xc50d,
0x8f1d, 0xc3a9,0x8fdd, 0xc248,0x90a1, 0xc0e9,0x9169, 0xbf8c,
0x9236, 0xbe32,0x9307, 0xbcda,0x93dc, 0xbb85,0x94b5, 0xba33,
0x9592, 0xb8e3,0x9674, 0xb796,0x9759, 0xb64c,0x9843, 0xb505,
0x9930, 0xb3c0,0x9a22, 0xb27f,0x9b17, 0xb140,0x9c11, 0xb005,
0x9d0e, 0xaecc,0x9e0f, 0xad97,0x9f14, 0xac65,0xa01c, 0xab36,
0xa129, 0xaa0a,0xa238, 0xa8e2,0xa34c, 0xa7bd,0xa463, 0xa69c,
0xa57e, 0xa57e,0xa69c, 0xa463,0xa7bd, 0xa34c,0xa8e2, 0xa238,
0xaa0a, 0xa129,0xab36, 0xa01c,0xac65, 0x9f14,0xad97, 0x9e0f,
0xaecc, 0x9d0e,0xb005, 0x9c11,0xb140, 0x9b17,0xb27f, 0x9a22,
0xb3c0, 0x9930,0xb505, 0x9843,0xb64c, 0x9759,0xb796, 0x9674,
0xb8e3, 0x9592,0xba33, 0x94b5,0xbb85, 0x93dc,0xbcda, 0x9307,
0xbe32, 0x9236,0xbf8c, 0x9169,0xc0e9, 0x90a1,0xc248, 0x8fdd,
0xc3a9, 0x8f1d,0xc50d, 0x8e62,0xc673, 0x8dab,0xc7db, 0x8cf8,
0xc946, 0x8c4a,0xcab2, 0x8ba0,0xcc21, 0x8afb,0xcd92, 0x8a5a,
0xcf04, 0x89be,0xd079, 0x8927,0xd1ef, 0x8894,0xd367, 0x8805,
0xd4e1, 0x877b,0xd65c, 0x86f6,0xd7d9, 0x8676,0xd958, 0x85fa,
0xdad8, 0x8583,0xdc59, 0x8511,0xdddc, 0x84a3,0xdf61, 0x843a,
0xe0e6, 0x83d6,0xe26d, 0x8377,0xe3f4, 0x831c,0xe57d, 0x82c6,
0xe707, 0x8276,0xe892, 0x822a,0xea1e, 0x81e2,0xebab, 0x81a0,
0xed38, 0x8163,0xeec6, 0x812a,0xf055, 0x80f6,0xf1e4, 0x80c8,
0xf374, 0x809e,0xf505, 0x8079,0xf695, 0x8059,0xf827, 0x803e,
0xf9b8, 0x8027,0xfb4a, 0x8016,0xfcdc, 0x800a,0xfe6e, 0x8002,
};
*/
const q15_t ALIGN4 twiddleCoefQ15N128[192] = {
0x7fff, 0x0,0x7fd9, 0x648,0x7f62, 0xc8c,0x7e9d, 0x12c8,
0x7d8a, 0x18f9,0x7c2a, 0x1f1a,0x7a7d, 0x2528,0x7885, 0x2b1f,
0x7642, 0x30fc,0x73b6, 0x36ba,0x70e3, 0x3c57,0x6dca, 0x41ce,
0x6a6e, 0x471d,0x66d0, 0x4c40,0x62f2, 0x5134,0x5ed7, 0x55f6,
0x5a82, 0x5a82,0x55f6, 0x5ed7,0x5134, 0x62f2,0x4c40, 0x66d0,
0x471d, 0x6a6e,0x41ce, 0x6dca,0x3c57, 0x70e3,0x36ba, 0x73b6,
0x30fc, 0x7642,0x2b1f, 0x7885,0x2528, 0x7a7d,0x1f1a, 0x7c2a,
0x18f9, 0x7d8a,0x12c8, 0x7e9d,0xc8c, 0x7f62,0x648, 0x7fd9,
0x0, 0x7fff,0xf9b8, 0x7fd9,0xf374, 0x7f62,0xed38, 0x7e9d,
0xe707, 0x7d8a,0xe0e6, 0x7c2a,0xdad8, 0x7a7d,0xd4e1, 0x7885,
0xcf04, 0x7642,0xc946, 0x73b6,0xc3a9, 0x70e3,0xbe32, 0x6dca,
0xb8e3, 0x6a6e,0xb3c0, 0x66d0,0xaecc, 0x62f2,0xaa0a, 0x5ed7,
0xa57e, 0x5a82,0xa129, 0x55f6,0x9d0e, 0x5134,0x9930, 0x4c40,
0x9592, 0x471d,0x9236, 0x41ce,0x8f1d, 0x3c57,0x8c4a, 0x36ba,
0x89be, 0x30fc,0x877b, 0x2b1f,0x8583, 0x2528,0x83d6, 0x1f1a,
0x8276, 0x18f9,0x8163, 0x12c8,0x809e, 0xc8c,0x8027, 0x648,
0x8000, 0x0,0x8027, 0xf9b8,0x809e, 0xf374,0x8163, 0xed38,
0x8276, 0xe707,0x83d6, 0xe0e6,0x8583, 0xdad8,0x877b, 0xd4e1,
0x89be, 0xcf04,0x8c4a, 0xc946,0x8f1d, 0xc3a9,0x9236, 0xbe32,
0x9592, 0xb8e3,0x9930, 0xb3c0,0x9d0e, 0xaecc,0xa129, 0xaa0a,
0xa57e, 0xa57e,0xaa0a, 0xa129,0xaecc, 0x9d0e,0xb3c0, 0x9930,
0xb8e3, 0x9592,0xbe32, 0x9236,0xc3a9, 0x8f1d,0xc946, 0x8c4a,
0xcf04, 0x89be,0xd4e1, 0x877b,0xdad8, 0x8583,0xe0e6, 0x83d6,
0xe707, 0x8276,0xed38, 0x8163,0xf374, 0x809e,0xf9b8, 0x8027,
};

/*
const q15_t ALIGN4 twiddleCoefQ15N64[96] = {
0x7fff, 0x0,0x7f62, 0xc8c,0x7d8a, 0x18f9,0x7a7d, 0x2528,
0x7642, 0x30fc,0x70e3, 0x3c57,0x6a6e, 0x471d,0x62f2, 0x5134,
0x5a82, 0x5a82,0x5134, 0x62f2,0x471d, 0x6a6e,0x3c57, 0x70e3,
0x30fc, 0x7642,0x2528, 0x7a7d,0x18f9, 0x7d8a,0xc8c, 0x7f62,
0x0, 0x7fff,0xf374, 0x7f62,0xe707, 0x7d8a,0xdad8, 0x7a7d,
0xcf04, 0x7642,0xc3a9, 0x70e3,0xb8e3, 0x6a6e,0xaecc, 0x62f2,
0xa57e, 0x5a82,0x9d0e, 0x5134,0x9592, 0x471d,0x8f1d, 0x3c57,
0x89be, 0x30fc,0x8583, 0x2528,0x8276, 0x18f9,0x809e, 0xc8c,
0x8000, 0x0,0x809e, 0xf374,0x8276, 0xe707,0x8583, 0xdad8,
0x89be, 0xcf04,0x8f1d, 0xc3a9,0x9592, 0xb8e3,0x9d0e, 0xaecc,
0xa57e, 0xa57e,0xaecc, 0x9d0e,0xb8e3, 0x9592,0xc3a9, 0x8f1d,
0xcf04, 0x89be,0xdad8, 0x8583,0xe707, 0x8276,0xf374, 0x809e,
};
*/

const uint16_t armBitRevTableN128[32] = {

0x20, 0x10, 0x30, 0x8, 0x28, 0x18, 0x38, 
0x4, 0x24, 0x14, 0x34, 0xc, 0x2c, 0x1c, 
0x3c, 0x2, 0x22, 0x12, 0x32, 0xa, 0x2a, 
0x1a, 0x3a, 0x6, 0x26, 0x16, 0x36, 0xe, 
0x2e, 0x1e, 0x3e, 0x1, 
};

/*
const uint16_t armBitRevTableN64[16] = {

0x10, 0x8, 0x18, 0x4, 0x14, 0xc, 0x1c, 
0x2, 0x12, 0xa, 0x1a, 0x6, 0x16, 0xe, 
0x1e, 0x1, 
};
*/

arm_status arm_cfft_radix4_init_q15(
  arm_cfft_radix4_instance_q15 * S,
  uint16_t fftLen,
  uint8_t ifftFlag,
  uint8_t bitReverseFlag)
{
  /*  Initialise the default arm status */
  arm_status status = ARM_MATH_SUCCESS;
  /*  Initialise the FFT length */
  S->fftLen = fftLen;
  /*  Initialise the Twiddle coefficient pointer */
  S->pTwiddle = (q15_t *) twiddleCoefQ15N128;
  /*  Initialise the Flag for selection of CFFT or CIFFT */
  S->ifftFlag = ifftFlag;
  /*  Initialise the Flag for calculation Bit reversal or not */
  S->bitReverseFlag = bitReverseFlag;

S->pBitRevTable = (uint16_t *) & armBitRevTableN128[1];
  /*  Initializations of structure parameters depending on the FFT length */
  switch (S->fftLen)
  {
  case 4096u:
  case 1024u:
  case 256u:
  case 64u:
  case 16u:
    break;
  default:
    /*  Reporting argument error if fftSize is not valid value */
    status = ARM_MATH_ARGUMENT_ERROR;
    break;
  }

  return (status);
}

/**    
 * @} end of Radix4_CFFT_CIFFT group    
 */
